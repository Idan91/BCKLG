{"ast":null,"code":"import{SET_USER,SET_ERRORS,CLEAR_ERRORS,LOADING_UI,LOADING_USER,SET_UNAUTHENTICATED}from\"../types\";import axios from\"axios\";export var loginUser=function loginUser(userData,history){return function(dispatch){dispatch({type:LOADING_UI});axios.post(\"/login\",userData).then(function(result){setAuthrizationHeader(result.data.token);dispatch(getUserData());dispatch({type:CLEAR_ERRORS});history.push(\"/my-backlog\");}).catch(function(err){dispatch({type:SET_ERRORS,payload:err.response.data});});};};export var signInWithFacebook=function signInWithFacebook(history){return function(dispatch){dispatch({type:LOADING_UI});axios.post(\"/signin/facebook\").then(function(result){console.log(\"fb\",result);var token=result.token,user=result.user;setAuthrizationHeader(token);dispatch(getUserData());dispatch({type:CLEAR_ERRORS});history.push(\"/my-backlog\");}).catch(function(err){dispatch({type:SET_ERRORS,payload:err.response.data});});};};export var signupUser=function signupUser(newUserData,history){return function(dispatch){dispatch({type:LOADING_UI});axios.post(\"/signup\",newUserData).then(function(){dispatch(getUserData());dispatch({type:CLEAR_ERRORS});history.push(\"/login\");}).catch(function(err){dispatch({type:SET_ERRORS,payload:err.response.data});});};};export var logoutUser=function logoutUser(){return function(dispatch){localStorage.removeItem(\"firebaseIdToken\");delete axios.defaults.headers.common[\"Authorization\"];dispatch({type:SET_UNAUTHENTICATED});};};export var getUserData=function getUserData(){return function(dispatch){dispatch({type:LOADING_USER});axios.get(\"/user\").then(function(result){dispatch({type:SET_USER,payload:result.data});}).catch(function(err){return console.log(err);});};};export var sendPasswordResetEmail=function sendPasswordResetEmail(i_Email){return function(dispatch){dispatch({type:LOADING_UI});var resetPasswordRequest={email:i_Email};axios.post(\"/user/reset-password\",resetPasswordRequest).then(function(){dispatch({type:CLEAR_ERRORS});window.alert(\"You should recieve password reset instructions \".concat(resetPasswordRequest.email,\" shortly\"));}).catch(function(err){dispatch({type:SET_ERRORS,payload:err.response.data});console.log(err);});};};export var sendEmailVerification=function sendEmailVerification(){return function(dispatch){dispatch({type:LOADING_UI});return new Promise(function(resolve,reject){axios.post(\"/user/email-verification\").then(function(){dispatch({type:CLEAR_ERRORS});dispatch(getUserData());var emailVerificationMsg=\"Email verification instructions sent.\";window.alert(emailVerificationMsg);resolve(true);}).catch(function(err){dispatch({type:SET_ERRORS,payload:err.response.data});console.log(err);reject(false);});});};};export var updateUserPassword=function updateUserPassword(i_UpdateRequest){return function(dispatch){dispatch({type:LOADING_UI});var updateRequest={email:i_UpdateRequest.email,currentPassword:i_UpdateRequest.currentPassword,newPassword:i_UpdateRequest.newPassword,confirmNewPassword:i_UpdateRequest.confirmNewPassword};return new Promise(function(resolve,reject){axios.post(\"/user/update-password\",updateRequest).then(function(){dispatch({type:CLEAR_ERRORS});dispatch(getUserData());var updateSuccessfullMsg=\"Password updated successfully\";window.alert(updateSuccessfullMsg);resolve(true);}).catch(function(err){dispatch({type:SET_ERRORS,payload:err.response.data});console.log(err);reject(false);});});};};export var updateGames=function updateGames(username,gameList){return function(dispatch){dispatch({type:LOADING_USER});var updateRequest={username:username,games:gameList};axios.post(\"user/games/update\",updateRequest).then(function(){dispatch(getUserData());dispatch({type:CLEAR_ERRORS});}).catch(function(err){return console.log(err);});};};export var deleteAccount=function deleteAccount(i_Username){return function(dispatch){dispatch({type:LOADING_USER});axios.post(\"user/delete\",i_Username).then(function(){dispatch(logoutUser());}).catch(function(err){return console.log(err);});};};var setAuthrizationHeader=function setAuthrizationHeader(token){var firebaseIdToken=\"Bearer \".concat(token);localStorage.setItem(\"firebaseIdToken\",firebaseIdToken);axios.defaults.headers.common[\"Authorization\"]=firebaseIdToken;};","map":{"version":3,"sources":["/Users/Idan/Projects/Dev/GitHub/BCKLG/src/redux/actions/userActions.js"],"names":["SET_USER","SET_ERRORS","CLEAR_ERRORS","LOADING_UI","LOADING_USER","SET_UNAUTHENTICATED","axios","loginUser","userData","history","dispatch","type","post","then","result","setAuthrizationHeader","data","token","getUserData","push","catch","err","payload","response","signInWithFacebook","console","log","user","signupUser","newUserData","logoutUser","localStorage","removeItem","defaults","headers","common","get","sendPasswordResetEmail","i_Email","resetPasswordRequest","email","window","alert","sendEmailVerification","Promise","resolve","reject","emailVerificationMsg","updateUserPassword","i_UpdateRequest","updateRequest","currentPassword","newPassword","confirmNewPassword","updateSuccessfullMsg","updateGames","username","gameList","games","deleteAccount","i_Username","firebaseIdToken","setItem"],"mappings":"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","sourcesContent":["import {\n  SET_USER,\n  SET_ERRORS,\n  CLEAR_ERRORS,\n  LOADING_UI,\n  LOADING_USER,\n  SET_UNAUTHENTICATED\n} from \"../types\";\nimport axios from \"axios\";\n\nexport const loginUser = (userData, history) => dispatch => {\n  dispatch({ type: LOADING_UI });\n  axios\n    .post(\"/login\", userData)\n    .then(result => {\n      setAuthrizationHeader(result.data.token);\n      dispatch(getUserData());\n      dispatch({ type: CLEAR_ERRORS });\n      history.push(\"/my-backlog\");\n    })\n    .catch(err => {\n      dispatch({\n        type: SET_ERRORS,\n        payload: err.response.data\n      });\n    });\n};\n\nexport const signInWithFacebook = history => dispatch => {\n  dispatch({ type: LOADING_UI });\n\n  axios\n    .post(\"/signin/facebook\")\n    .then(result => {\n      console.log(\"fb\", result);\n      const { token, user } = result;\n      setAuthrizationHeader(token);\n      dispatch(getUserData());\n      dispatch({ type: CLEAR_ERRORS });\n      history.push(\"/my-backlog\");\n    })\n    .catch(err => {\n      dispatch({\n        type: SET_ERRORS,\n        payload: err.response.data\n      });\n    });\n};\n\nexport const signupUser = (newUserData, history) => dispatch => {\n  dispatch({ type: LOADING_UI });\n  axios\n    .post(\"/signup\", newUserData)\n    .then(() => {\n      dispatch(getUserData());\n      dispatch({ type: CLEAR_ERRORS });\n      history.push(\"/login\");\n    })\n    .catch(err => {\n      dispatch({\n        type: SET_ERRORS,\n        payload: err.response.data\n      });\n    });\n};\n\nexport const logoutUser = () => dispatch => {\n  localStorage.removeItem(\"firebaseIdToken\");\n  delete axios.defaults.headers.common[\"Authorization\"];\n  dispatch({ type: SET_UNAUTHENTICATED });\n};\n\nexport const getUserData = () => dispatch => {\n  dispatch({ type: LOADING_USER });\n\n  axios\n    .get(\"/user\")\n    .then(result => {\n      dispatch({\n        type: SET_USER,\n        payload: result.data\n      });\n    })\n    .catch(err => console.log(err));\n};\n\nexport const sendPasswordResetEmail = i_Email => dispatch => {\n  dispatch({ type: LOADING_UI });\n\n  const resetPasswordRequest = {\n    email: i_Email\n  };\n\n  axios\n    .post(\"/user/reset-password\", resetPasswordRequest)\n    .then(() => {\n      dispatch({ type: CLEAR_ERRORS });\n      window.alert(\n        `You should recieve password reset instructions ${resetPasswordRequest.email} shortly`\n      );\n    })\n    .catch(err => {\n      dispatch({\n        type: SET_ERRORS,\n        payload: err.response.data\n      });\n      console.log(err);\n    });\n};\n\nexport const sendEmailVerification = () => dispatch => {\n  dispatch({ type: LOADING_UI });\n\n  return new Promise((resolve, reject) => {\n    axios\n      .post(\"/user/email-verification\")\n      .then(() => {\n        dispatch({ type: CLEAR_ERRORS });\n        dispatch(getUserData());\n        let emailVerificationMsg = \"Email verification instructions sent.\";\n        window.alert(emailVerificationMsg);\n        resolve(true);\n      })\n      .catch(err => {\n        dispatch({\n          type: SET_ERRORS,\n          payload: err.response.data\n        });\n        console.log(err);\n        reject(false);\n      });\n  });\n};\n\nexport const updateUserPassword = i_UpdateRequest => dispatch => {\n  dispatch({ type: LOADING_UI });\n\n  const updateRequest = {\n    email: i_UpdateRequest.email,\n    currentPassword: i_UpdateRequest.currentPassword,\n    newPassword: i_UpdateRequest.newPassword,\n    confirmNewPassword: i_UpdateRequest.confirmNewPassword\n  };\n\n  return new Promise((resolve, reject) => {\n    axios\n      .post(\"/user/update-password\", updateRequest)\n      .then(() => {\n        dispatch({ type: CLEAR_ERRORS });\n        dispatch(getUserData());\n        let updateSuccessfullMsg = \"Password updated successfully\";\n        window.alert(updateSuccessfullMsg);\n        resolve(true);\n      })\n      .catch(err => {\n        dispatch({\n          type: SET_ERRORS,\n          payload: err.response.data\n        });\n        console.log(err);\n        reject(false);\n      });\n  });\n};\n\nexport const updateGames = (username, gameList) => dispatch => {\n  dispatch({ type: LOADING_USER });\n  const updateRequest = {\n    username: username,\n    games: gameList\n  };\n  axios\n    .post(\"user/games/update\", updateRequest)\n    .then(() => {\n      dispatch(getUserData());\n      dispatch({ type: CLEAR_ERRORS });\n    })\n    .catch(err => console.log(err));\n};\n\nexport const deleteAccount = i_Username => dispatch => {\n  dispatch({ type: LOADING_USER });\n  axios\n    .post(\"user/delete\", i_Username)\n    .then(() => {\n      dispatch(logoutUser());\n    })\n    .catch(err => console.log(err));\n};\n\nconst setAuthrizationHeader = token => {\n  const firebaseIdToken = `Bearer ${token}`;\n  localStorage.setItem(\"firebaseIdToken\", firebaseIdToken);\n  axios.defaults.headers.common[\"Authorization\"] = firebaseIdToken;\n};\n"]},"metadata":{},"sourceType":"module"}